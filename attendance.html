<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CMS COLLEGE - Attendance</title>
  <style>
    :root {
      --primary: #c62828;
      --primary-dark: #8e0000;
      --secondary: #ffffff;
      --gray: #f4f6f9;
      --dark: #2d3436;
      --text-light: #636e72;
      --success: #2ecc71;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background: var(--gray);
      color: var(--dark);
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    .navbar {
      background: var(--primary);
      color: var(--secondary);
      padding: 15px 25px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 3px 8px rgba(0,0,0,0.15);
    }
    .navbar h2 { font-size: 20px; }

    .container {
      flex: 1;
      max-width: 1000px;
      margin: 30px auto;
      padding: 25px;
      background: var(--secondary);
      border-radius: 12px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.1);
    }

    .page-title {
      text-align: center;
      margin-bottom: 5px;
      font-size: 24px;
      font-weight: bold;
      color: var(--primary);
    }
    .date {
      text-align: center;
      font-size: 15px;
      color: var(--text-light);
      margin-bottom: 25px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }
    th, td {
      border: 1px solid #e0e0e0;
      padding: 12px;
      text-align: center;
    }
    th {
      background: var(--primary);
      color: var(--secondary);
      text-transform: uppercase;
      font-size: 14px;
    }
    tr:nth-child(even) { background: #fafafa; }
    tr:hover td { background: #fff5f5; }

    label { cursor: pointer; font-weight: 500; color: var(--success); }
    input[type="checkbox"] {
      transform: scale(1.2);
      margin-right: 6px;
      cursor: pointer;
    }

    /* ✅ PRESENT COUNT BOX */
    .present-count {
      font-size: 16px;
      font-weight: bold;
      margin-bottom: 15px;
      padding: 10px;
      background: #eafaf1;
      border: 1px solid #2ecc71;
      border-radius: 6px;
      color: #27ae60;
      text-align: center;
    }

    .btn {
      display: inline-block;
      width: 100%;
      background: var(--primary);
      color: var(--secondary);
      border: none;
      padding: 14px;
      font-size: 16px;
      font-weight: bold;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    .btn:hover { background: var(--primary-dark); }

    .message {
      display: none;
      margin-top: 15px;
      padding: 12px;
      border-radius: 6px;
      font-weight: 500;
      text-align: center;
    }
    .message.success { background: #e9f9f0; color: #27ae60; border: 1px solid #2ecc71; }

    footer {
      text-align: center;
      background: var(--dark);
      color: var(--secondary);
      padding: 15px;
      font-size: 14px;
      margin-top: auto;
    }
  </style>
</head>
<body>
  <!-- NAVBAR -->
  <div class="navbar">
    <h2>CMS COLLEGE</h2>
    <span>Attendance Portal</span>
  </div>

  <!-- MAIN CONTENT -->
  <div class="container">
    <div class="page-title">BCA 5th Sem - Attendance</div>
    <div class="date" id="todayDate"></div>

    <form id="attendanceForm">
      <table>
        <thead>
          <tr>
            <th>Roll No</th>
            <th>Student Name</th>
            <th>Present?</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>101</td>
            <td>Rahul Sharma</td>
            <td><label><input type="checkbox" name="s101"> Present</label></td>
          </tr>
          <tr>
            <td>102</td>
            <td>Priya Verma</td>
            <td><label><input type="checkbox" name="s102"> Present</label></td>
          </tr>
          <tr>
            <td>103</td>
            <td>Amit Kumar</td>
            <td><label><input type="checkbox" name="s103"> Present</label></td>
          </tr>
		  <tr>
  <td>104</td>
  <td>Neha Singh</td>
  <td><label><input type="checkbox" name="s104"> Present</label></td>
</tr>
<tr>
  <td>105</td>
  <td>Rohit Mehra</td>
  <td><label><input type="checkbox" name="s105"> Present</label></td>
</tr>
<tr>
  <td>106</td>
  <td>Sanya Kapoor</td>
  <td><label><input type="checkbox" name="s106"> Present</label></td>
</tr>
<tr>
  <td>107</td>
  <td>Aditya Jain</td>
  <td><label><input type="checkbox" name="s107"> Present</label></td>
</tr>
<tr>
  <td>108</td>
  <td>Divya Gupta</td>
  <td><label><input type="checkbox" name="s108"> Present</label></td>
</tr>
<tr>
  <td>109</td>
  <td>Vikram Chauhan</td>
  <td><label><input type="checkbox" name="s109"> Present</label></td>
</tr>
<tr>
  <td>110</td>
  <td>Ankita Sharma</td>
  <td><label><input type="checkbox" name="s110"> Present</label></td>
</tr>
<tr>
  <td>111</td>
  <td>Mayank Verma</td>
  <td><label><input type="checkbox" name="s111"> Present</label></td>
</tr>
<tr>
  <td>112</td>
  <td>Ritika Kapoor</td>
  <td><label><input type="checkbox" name="s112"> Present</label></td>
</tr>
<tr>
  <td>113</td>
  <td>Sahil Arora</td>
  <td><label><input type="checkbox" name="s113"> Present</label></td>
</tr>

          <!-- Add more students here -->
        </tbody>
      </table>

      <!-- ✅ PRESENT COUNT BOX -->
      <div id="presentCountBox" class="present-count">
        Total Present Students: 0
      </div>

      <button type="submit" class="btn">Submit Attendance</button>
      <div id="messageBox" class="message"></div>
    </form>
  </div>

  <!-- FOOTER -->
  <footer>
    © 2025 CMS College. All Rights Reserved.
  </footer>
  
  
  

 <script>
const today = new Date();
document.getElementById("todayDate").innerText = today.toLocaleDateString("en-IN",{weekday:"long",year:"numeric",month:"long",day:"numeric"});

const checkboxes = document.querySelectorAll("tbody input[type=checkbox]");
const presentCountBox = document.getElementById("presentCountBox");

function updatePresentCount() {
  let count=0;
  checkboxes.forEach(cb=>{if(cb.checked) count++;});
  presentCountBox.innerText=`Total Present Students: ${count}`;
}

checkboxes.forEach(cb=>cb.addEventListener("change", updatePresentCount));
updatePresentCount();

document.getElementById("attendanceForm").addEventListener("submit", async function(e){
  e.preventDefault();
  const rows = document.querySelectorAll("tbody tr");
  const todayDB = new Date().toISOString().split("T")[0];
  const data = [];
  rows.forEach(row=>{
    const roll=row.cells[0].innerText;
    const name=row.cells[1].innerText;
    const isPresent=row.querySelector("input[type=checkbox]").checked;
    data.push({roll,name,date:todayDB,status:isPresent?"Present":"Absent"});
  });

  const scriptURL="https://script.google.com/macros/s/AKfycbw9582LlpIMGVhrH-bXMHWwGlDasjvpSa_FDCL-ehJ0XryuhVIo_ormRL1d8qhS2repfg/exec";

  await fetch(scriptURL,{
    method:"POST",
    mode:"no-cors",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify(data)
  });

  const msgBox=document.getElementById("messageBox");
  msgBox.className="message success";
  msgBox.innerText=`✅ Attendance saved to Google Sheet for ${todayDB}`;
  msgBox.style.display="block";
});
</script>
</body>
</html>
